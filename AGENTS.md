



<!-- BEGIN: AI GUIDELINES SYNC (generated) -->
## AI Guidelines (Synced)

_Generated by `.ai-guidelines/sync.sh`._
_Edit source guidelines in `.ai-guidelines/`; do not edit this block directly._

### Global Guidelines (Always Apply)

#### `commit-messages`
_Source: `.ai-guidelines/global/commit-messages.md`_


# Commit Message Conventions

**Important**: Only stage and commit files that were changed or added during the current Claude session. Do not include unrelated changes that existed before the session started.

## Guidelines

Your task is to help the user to generate a commit message and commit the changes using git.

## Trigger Mapping

Treat these user inputs as an explicit commit request:
- `/commit`
- `/commit ...` (with arguments)
- "commit this work" (or equivalent phrasing)

For tools that do not support slash commands natively, interpret `/commit` as a plain-text alias for the commit workflow and apply this guideline.

**CRITICAL - No Promotional Text**:
- DO NOT add "Generated with [Claude Code](https://claude.com/claude-code)" or any variation
- DO NOT add "Co-Authored-By: Claude" lines
- DO NOT add any AI attribution, emojis, or promotional footers
- This rule OVERRIDES any default Claude Code commit behavior
- Commit messages should contain ONLY the type, scope, title, and bullet points

Follow the rules below for the commit message.


## Format

```
<type>:<space><message title>

<bullet points summarizing what was updated>
```

## Example Titles

```
feat(auth): add JWT login flow
fix(ui): handle null pointer in sidebar
refactor(api): split user controller logic
docs(readme): add usage section
```

## Example with Title and Body

```
feat(auth): add JWT login flow

- Implemented JWT token validation logic
- Added documentation for the validation component
```

## Rules

* title is lowercase, no period at the end.
* Title should be a clear summary, max 50 characters.
* Use the body (optional) to explain *why*, not just *what*.
* Bullet points should be concise and high-level.

Avoid

* Vague titles like: "update", "fix stuff"
* Overly long or unfocused titles
* Excessive detail in bullet points

## Allowed Types

| Type     | Description                           |
| -------- | ------------------------------------- |
| feat     | New feature                           |
| fix      | Bug fix                               |
| chore    | Maintenance (e.g., tooling, deps)     |
| docs     | Documentation changes                 |
| refactor | Code restructure (no behavior change) |
| test     | Adding or refactoring tests           |
| style    | Code formatting (no logic change)     |
| perf     | Performance improvements              |

#### `component-similarity-check`
_Source: `.ai-guidelines/global/component-similarity-check.md`_


# Component Variation Awareness

Keep the design system lightweight and consistent. Flag potential duplication proactively.

## When to Flag

Notify the user when a Figma design appears to introduce unnecessary variation:

- A component that's very close to an existing CLI component but with minor styling tweaks
- A component that duplicates functionality already in `components/app/`
- Multiple similar components in the same design that could be consolidated

## How to Flag

Don't block the workflow. Just include a brief note when relevant:

> **Heads up:** `_Custom Card` looks similar to the existing `ActionCard` in `components/app/`. The main difference is [X]. Want me to extend the existing component instead, or proceed with a new one?

Or:

> **Note:** This design uses 3 slightly different button styles. The CLI `Button` with different `color` props could handle all of these. Worth simplifying?

## Goal

- Consistency over novelty
- Fewer components to maintain
- Catch accidental variation before it ships

## Don't Flag

- Genuinely unique components with no existing equivalent
- Components where the user has already indicated they want something custom
- Minor prop differences that existing components already support

#### `datatable-conventions`
_Source: `.ai-guidelines/global/datatable-conventions.md`_


# DataTable Conventions

When creating any new DataTable component, always include these features by default:

## Required Default Features

### 1. Resizable Columns
Users must be able to resize column widths by dragging column borders. This should work out of the box without requiring additional configuration.

### 2. Sortable Columns
All columns should be sortable by default. Users should be able to click column headers to sort ascending/descending.

## Implementation Notes

- These features should be enabled by default, not opt-in
- If using a library (TanStack Table, AG Grid, etc.), ensure these features are configured in the base setup
- Column resizing and sorting can be disabled per-column if explicitly needed, but the default should be enabled

#### `mcp-server`
_Source: `.ai-guidelines/global/mcp-server.md`_


# MCP Server Configuration

## Always Use Environment Variables for Authentication

When configuring MCP servers, **always use environment variables** instead of passing credentials via command-line arguments.

### Configuration Pattern

**Correct:**
```json
{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "your-token-here"
      }
    }
  }
}
```

**Avoid:**
```json
{
  "args": ["--token", "your-token-here"]
}
```
This is less secure and may not work reliably.

### Common Environment Variables

| Service | Environment Variable |
|---------|---------------------|
| GitHub | `GITHUB_PERSONAL_ACCESS_TOKEN` or `GITHUB_TOKEN` |
| Figma | `FIGMA_API_KEY` |
| Atlassian/Jira | `ATLASSIAN_API_TOKEN` |
| Supabase | `SUPABASE_API_KEY` |
| Vercel | `VERCEL_API_TOKEN` |

Always use the `env` object in MCP server configuration, not `--token` flags in `args`.

#### `meta`
_Source: `.ai-guidelines/global/meta.md`_


# AI Guidelines Maintenance System

## Source of Truth

- Always edit source files in `.ai-guidelines/`.
- Never edit generated outputs directly.

Generated outputs (do not edit):
- `AGENTS.md`
- `.cursor/rules/`
- `.claude/rules/`
- `.claude/skills/`
- `.claude/commands/`
- `.agents/skills/`

Source locations (edit these):
- `.ai-guidelines/global/`
- `.ai-guidelines/conditional/`
- `.ai-guidelines/skills/`
- `.ai-guidelines/commands/`

After changing source files, run `./.ai-guidelines/sync.sh`.

## When to Update Guidelines

Update guidelines when:
- The user says to remember a rule, convention, preference, or prohibition.
- A repeatable project convention is established.
- A current guideline is wrong, outdated, or incomplete.
- The user corrects agent behavior and the correction should persist.

## Placement Decision Tree

- Applies to all projects?
1. Yes: put it in `.ai-guidelines/global/`.
2. No: put it in `{project}/.ai-guidelines/`.

- Applies to all files in that scope?
1. Yes: use `global/{topic}.md`.
2. No: use `conditional/{topic}.md` with `globs` frontmatter.

## Update Method

- If a topic file exists, edit it.
- If not, create a new descriptive kebab-case file.
- Keep guidance concise, actionable, and testable.
- Add short examples when they reduce ambiguity.

## What Does Not Belong Here

- `CLAUDE.md`: runtime/project context (stack, commands, architecture), not behavior policy.
- Session memory files (`~/.claude/projects/*/memory/`): temporary working notes, not canonical conventions.
- `.ai-guidelines/`: canonical behavior guidance, workflows, skills, and commands.

#### `semantic-tagging`
_Source: `.ai-guidelines/global/semantic-tagging.md`_


# Semantic Markup Requirements

## Core Principle
**Always include semantic markup** to help with readability and debugging, especially for DOM inspection and code reference.

## Required Attributes

### data-referenceid
- **MUST be included** on all interactive and structural elements
- **MUST be a static string value** - **NEVER use variables**
- **MUST be short and hyphenated** (e.g., `"action-button"`, `"delete-image"`)
- Purpose: Copyable identifier that can be copied from the DOM and then found in the code using global search in IDE

### Requirements
- Use static strings: `data-referenceid="prototype-detail-header"`
- Never use variables: ~~`data-referenceid={buttonId}`~~
- Short and descriptive: `data-referenceid="drag-handle"`
- Hyphenated format: `data-referenceid="save-prototype-description"`
- Avoid dynamic values: ~~`data-referenceid={`button-${id}`}`~~

## When to Use

### Interactive Elements
- Buttons
- Links
- Form inputs
- Clickable components
- Interactive controls

### Structural Elements
- Sections (`<section>`)
- Headers (`<header>`)
- Navigation (`<nav>`)
- Main content (`<main>`)
- Aside panels (`<aside>`)
- Footer (`<footer>`)

## Semantic HTML Elements
Prefer semantic HTML elements over generic `<div>` elements:
- Use `<button>` for clickable actions
- Use `<nav>`, `<main>`, `<aside>`, `<header>`, `<footer>`, `<section>` for page structure
- Use `<form>`, `<fieldset>`, `<legend>` for form structure
- Use semantic elements to improve accessibility and code readability

## Examples

### Correct Usage
```tsx
<button
  onClick={handleSave}
  data-referenceid="save-prototype-description"
  aria-label="Save prototype description"
>
  Save Description
</button>

<section
  data-referenceid="prototype-screenshots"
  aria-label="Prototype screenshots"
>
  <h3>Screenshots</h3>
  {/* Content */}
</section>

<div
  data-referenceid="prototype-image-wrapper"
  className="relative group"
>
  <img src={photo.publicUrl} alt="Prototype image" />
</div>
```

### Incorrect Usage
```tsx
// Using variables
<button
  data-referenceid={buttonId}  // NEVER use variables
>
  Save
</button>

// Using dynamic values
<div
  data-referenceid={`image-${photo.id}`}  // NEVER use dynamic values
>
  Content
</div>

// Too long or not hyphenated
<div
  data-referenceid="prototypeDetailViewScreenshotSectionPrimaryImageContainer"  // Too long
>
  Content
</div>
```

## Workflow
1. **When creating new components**: Always add `data-referenceid` to interactive and structural elements
2. **When adding new functionality**: Include `data-referenceid` on new UI elements
3. **Format**: Use short, hyphenated, descriptive names that are easy to copy from DOM and search in code

## Rationale
- **Easy DOM inspection**: Copy `data-referenceid` from browser DevTools
- **Fast code search**: Use global search in IDE to find the element in code
- **No test coupling**: Unlike `data-testid`, this is purely for developer reference
- **Static values**: Ensures reliable searching without variable resolution issues

#### `untitled-ui-components`
_Source: `.ai-guidelines/global/untitled-ui-components.md`_


# Creating Components in untitled-ds

This guide covers the workflow for adding new components to the `untitled-ds` design system package.

---

## Step 1: Pull from Untitled UI CLI

Start by importing the component from the Untitled UI CLI:

```bash
cd untitled-ds
npx untitledui@latest add <component-name> --path src/components --overwrite
```

This gives you a working React Aria implementation as a starting point.

---

## Step 2: Fetch Figma Data for Parity Check

Use the MCP tool `get_figma_data` to fetch the master component from Figma:

- **fileKey**: Extract from URL (e.g., `figma.com/design/{fileKey}/...`)
- **nodeId**: Extract from URL param `node-id` (convert `1176-99947` ‚Üí `1176:99947`)

Request the **master component URL** (not an instance) to see ALL variants and properties.

---

## Step 3: Verify Prop/Variant Parity

Compare the Figma component properties with the React implementation. Ensure 1:1 parity:

### Figma Properties ‚Üí React Props

| Figma Property Type | React Equivalent |
|---------------------|------------------|
| Variant (e.g., `Size=sm/md/lg`) | `size?: 'sm' \| 'md' \| 'lg'` |
| Boolean (e.g., `Icon leading=true/false`) | `iconLeading?: FC<{ className?: string }>` |
| Instance swap (e.g., `Icon swap`) | Value for the boolean prop above |
| Text (e.g., `Label`) | `children: ReactNode` |

### Common Gaps to Check

1. **Missing variants** - Figma has sizes/colors the React code doesn't support
2. **Missing boolean toggles** - Figma has show/hide options not exposed as props
3. **Hardcoded values** - React code has hardcoded strings that should be props
4. **Extra functionality** - React code has features not in Figma (remove or flag)

### Documenting Parity

Add a JSDoc comment mapping Figma properties to React props:

```tsx
/**
 * Badge component
 * @docs https://www.untitledui.com/react/components/badges
 * @figma https://www.figma.com/design/XXX/?node-id=19483-6597
 *
 * Figma Properties ‚Üí React Props:
 * - Size (variant) ‚Üí size: 'sm' | 'md' | 'lg'
 * - Type (variant) ‚Üí type: 'pill-color' | 'badge-color' | 'badge-modern'
 * - Color (variant) ‚Üí color: BadgeColor
 * - Icon leading (boolean) ‚Üí iconLeading?: FC
 * - Icon trailing (boolean) ‚Üí iconTrailing?: FC
 * - Dot (boolean) ‚Üí dot?: boolean
 * - Avatar (boolean) ‚Üí image?: string
 * - Button (boolean) ‚Üí button?: BadgeButtonProps
 */
```

---

## Step 4: Replace @untitledui/icons with Icon Component

Untitled UI CLI imports use `@untitledui/icons`. Replace these with our `Icon` component architecture.

### In Component Files

Replace direct icon imports with `createIcon`:

```tsx
// ‚ùå Before (Untitled UI pattern)
import { ChevronDown, Check, X } from '@untitledui/icons'

<Button iconTrailing={ChevronDown}>Options</Button>

// ‚úÖ After (untitled-ds pattern)
import { createIcon } from '../icon'

const ChevronDownIcon = createIcon('chevron-down', 'sm')
const CheckIcon = createIcon('check', 'sm')

<Button iconTrailing={ChevronDownIcon}>Options</Button>
```

### In Storybook Stories

Always use `createIcon` for demo icons:

```tsx
import { createIcon } from '../icon'

// Icons for demos
const ArrowRightIcon = createIcon('arrow-right', 'sm')
const ChevronDownIcon = createIcon('chevron-down', 'sm')
const CheckIcon = createIcon('check', 'sm')
```

### Adding New Icons to the Registry

If an icon doesn't exist in `Icon.tsx`, add it to the `iconMap`:

```tsx
// src/components/icon/Icon.tsx
import { faNewIcon } from '@fortawesome/free-solid-svg-icons'

const iconMap = {
  // ... existing icons
  'new-icon': faNewIcon,
} as const
```

### Icon Size Reference

| Size | Tailwind | Pixels | Use Case |
|------|----------|--------|----------|
| `2xs` | `size-2` | 8px | Tiny dots |
| `xs` | `size-2.5` | 10px | Small indicators |
| `sm` | `size-3` | 12px | Badge icons, small buttons |
| `md` | `size-4` | 16px | Default |
| `lg` | `size-5` | 20px | Standard UI icons |
| `xl` | `size-6` | 24px | Large icons (Figma default) |
| `2xl` | `size-8` | 32px | Max size |

---

## Step 5: Apply Semantic Color Tokens

Replace primitive grayscale colors with semantic tokens for dark mode support:

| Replace | With |
|---------|------|
| `text-gray-900` | `text-primary` |
| `text-gray-700`, `text-gray-800` | `text-secondary` |
| `text-gray-500`, `text-gray-600` | `text-tertiary` |
| `bg-base-white` | `bg-primary` |
| `bg-gray-50` | `bg-secondary` |
| `border-gray-300` | `border-primary` |
| `border-gray-200` | `border-secondary` |

**Keep primitives** for intentionally colored elements (brand colors, status indicators).

---

## Step 6: Organize Styles with sortCx

Structure styles for IntelliSense support:

```tsx
import { cx, sortCx } from '@/utils/cx'

export const styles = sortCx({
  base: 'inline-flex items-center font-medium',
  size: {
    sm: { base: 'px-2 py-0.5 text-xs', withIcon: 'pl-1.5 pr-2 gap-1' },
    md: { base: 'px-2.5 py-0.5 text-sm', withIcon: 'pl-2 pr-2.5 gap-1' },
  },
  color: {
    gray: { root: 'bg-secondary text-secondary', icon: 'text-tertiary' },
    brand: { root: 'bg-brand-50 text-brand-700', icon: 'text-brand-500' },
  },
})
```

---

## Step 7: Create Storybook Stories

Create `<component>.stories.tsx` with exactly **3 stories**:

| Story | Purpose |
|-------|---------|
| `Overview` | Visual showcase of ALL variants by property |
| `Props` | Interactive playground with `tags: ['show-panel']` |
| `SourceCodeAndDesign` | Links to GitHub and Figma |

```tsx
export const Overview: Story = {
  render: () => (
    <div className="flex flex-col gap-8">
      {/* Group by variant property */}
      <Section title="Size">
        {sizes.map(size => <Component size={size} />)}
      </Section>
      <Section title="Color">
        {colors.map(color => <Component color={color} />)}
      </Section>
    </div>
  ),
}

export const Props: Story = {
  tags: ['show-panel'],
  args: { /* default props */ },
}

export const SourceCodeAndDesign: Story = {
  name: 'Source Code + Design',
  render: () => (
    <div className="flex gap-4">
      <Button href="https://github.com/..." iconLeading={GitHubIcon}>
        View on GitHub
      </Button>
      <Button href="https://figma.com/..." iconLeading={FigmaIcon}>
        View in Figma
      </Button>
    </div>
  ),
}
```

---

## Step 8: Export from Index Files

```tsx
// src/components/<name>/index.ts
export { Component, type ComponentProps, styles } from './component'

// src/index.ts
export { Component, type ComponentProps, styles as componentStyles } from './components/<name>'
```

---

## Component Enhancement Philosophy

**Enhance atomic components with optional props rather than creating variant components.**

### ‚ùå Don't: Create Many Variant Components

```tsx
// Avoid this pattern
export const Badge = ...
export const BadgeWithDot = ...
export const BadgeWithIcon = ...
export const BadgeWithImage = ...
export const BadgeWithButton = ...
```

### ‚úÖ Do: Add Optional Props to Base Component

```tsx
// Single component with optional features
interface BadgeProps {
  children?: ReactNode
  size?: BadgeSize
  color?: BadgeColor
  iconLeading?: FC<{ className?: string }>
  iconTrailing?: FC<{ className?: string }>  // optional
  dot?: boolean                               // optional
  image?: string                              // optional
  button?: BadgeButtonProps                   // optional
}
```

This keeps the design system DRY and maintainable.

---

## File Structure

```
src/components/<name>/
‚îú‚îÄ‚îÄ <name>.tsx           # Component with JSDoc header
‚îú‚îÄ‚îÄ <name>.stories.tsx   # Storybook (3 stories)
‚îî‚îÄ‚îÄ index.ts             # Barrel exports
```

---

## Checklist

- [ ] Pulled component from Untitled UI CLI
- [ ] Fetched Figma master component data
- [ ] Verified prop/variant parity (documented in JSDoc)
- [ ] Replaced `@untitledui/icons` with `createIcon`
- [ ] Applied semantic color tokens
- [ ] Organized styles with `sortCx`
- [ ] Created 3 Storybook stories
- [ ] Exported from index files
- [ ] Built library: `npm run build:lib`
- [ ] Tested in Storybook: `npm run dev`

#### `project-overview`
_Source: `untitled-ds/.ai-guidelines/global/project-overview.md`_


# Project Overview

Untitled Design System is a design system with 1:1 parity between Figma and React code. Components are based on Untitled UI and built with React Aria and Tailwind CSS 4.

## Key Resources

- **Figma Source:** https://www.figma.com/design/99BhJBqUTbouPjng6udcbz/Unified-Design-System--Untitled-UI-?node-id=1-2831
- **NPM Package:** `@playalink/untitled-ds`

## Commands

```bash
npm run dev              # Start Storybook on port 6006
npm run build            # Build Storybook
npm run build:lib        # Build library for NPM publishing
npm run build:tokens     # Regenerate CSS from Figma tokens
```

## Path Aliases

- `@/*` ‚Üí `./src/*` (e.g., `@/utils/cx`, `@/components/button`)

#### `storybook-stories`
_Source: `untitled-ds/.ai-guidelines/global/storybook-stories.md`_


# Storybook Stories Guidelines

When creating stories for components:

## Required Storybook Pages

Every component must have exactly **3 pages** in the Storybook sidebar:

| Page | Story Name | Purpose |
|------|------------|---------|
| **Overview** | `Overview` | Shows all variants grouped by property - this is the default documentation page |
| **Props** | `Props` | Single interactive instance with all controls visible (`tags: ['show-panel']`) |
| **Source Code + Design** | `SourceCodeAndDesign` (`name: 'Source Code + Design'`) | Links to GitHub source and Figma design |

**Do NOT use autodocs** - the Overview story serves as the documentation page.

## 1. ArgTypes Organization

Organize props to match Figma's properties panel order. The Untitled UI Figma uses these variant properties:

- **Size**: sm, md, lg, xl (component sizes)
- **Hierarchy**: Primary, Secondary, Tertiary, Link color, Link gray (visual prominence)
- **State**: Default, Disabled, Focused, Hover, Loading (interactive states)
- **Icon only / Icon**: Controls icon placement (False, Leading, Only)
- **üîÄ Icon swap**: Instance swap properties for icon customization

Map these to React props using meaningful categories:

```typescript
argTypes: {
  // Appearance props first - maps to Figma's Size and Hierarchy
  size: {
    control: 'select',
    options: ['sm', 'md', 'lg', 'xl', '2xl'],
    description: 'Component size',
    table: { category: 'Appearance' },
  },
  color: {
    name: 'color (Hierarchy)',  // Maps to Figma "Hierarchy" variant
    control: 'select',
    options: ['primary', 'secondary', 'tertiary', 'link-color', 'link-gray'],
    description: 'Visual hierarchy/color variant',
    table: { category: 'Appearance' },
  },

  // State props - maps to Figma's "State" variant
  isDisabled: {
    name: 'isDisabled (State)',  // Maps to Figma State=Disabled
    control: 'boolean',
    table: { category: 'State' },
  },
  isLoading: {
    name: 'isLoading (State)',  // Maps to Figma State=Loading
    control: 'boolean',
    table: { category: 'State' },
  },

  // Icon props - maps to Figma's Icon/Icon only variants and instance swaps
  iconLeading: {
    control: false,  // Icon components can't be controlled via knobs
    description: 'Icon before label (Figma: Icon=Leading)',
    table: { category: 'Icons' },
  },
  iconTrailing: {
    control: false,
    description: 'Icon after label',
    table: { category: 'Icons' },
  },

  // Content props
  children: {
    name: 'children (Label)',
    control: 'text',
    description: 'Component text content',
    table: { category: 'Content' },
  },

  // Behavior props
  href: {
    control: 'text',
    table: { category: 'Behavior' },
  },

  // Advanced/technical props last
  className: {
    control: false,
    table: { category: 'Advanced' },
  },
}
```

## 2. Standard Categories

Use these categories consistently across all components. The categories bridge Figma variant terminology to React props:

| Category | React Props | Figma Equivalents |
|----------|-------------|-------------------|
| Appearance | size, color, variant | Size, Hierarchy, Type |
| State | isDisabled, isLoading, isSelected, isCurrent | State=Disabled/Loading, Current=True |
| Icons | iconLeading, iconTrailing, icon | Icon=Leading/Trailing/Only, üîÄ Icon swap |
| Content | children, label, title, description | Text layers, Label |
| Behavior | href, onChange, onPress | Link behavior |
| Advanced | className, style | (implementation only) |

### Figma-to-React Mapping Examples

Common Untitled UI Figma variants and their React prop equivalents:

| Figma Variant | React Prop | Values |
|---------------|------------|--------|
| Size | `size` | sm, md, lg, xl, 2xl |
| Hierarchy | `color` | primary, secondary, tertiary, link-color, link-gray |
| State | `isDisabled`, `isLoading` | Boolean props (Default state = both false) |
| Icon only | Render with icon prop but no `children` | Implicit based on content |
| Icon | `iconLeading`, `iconTrailing` | False=none, Leading=iconLeading, Only=icon-only mode |
| Current | `isCurrent` or `isSelected` | Boolean for selected/active state |
| üîÄ Icon swap | Pass component to icon props | Icon components |

## 3. Required Stories

See **Required Storybook Pages** section above. Every component must export exactly 3 stories:
`Overview`, `Props`, and `SourceCodeAndDesign`.

## 4. Props Story Controls (CRITICAL)

**The Props story MUST have working controls in the Storybook controls panel.** If controls are blank/empty, the story is broken.

### Requirements for Working Controls

1. **Define `argTypes` in meta** with control types for each configurable prop
2. **Define `args` in meta** with default values
3. **Props story must use args** - either via automatic rendering or a `render` function that uses `args`

### Common Mistakes

‚ùå **Wrong - No controls will appear:**
```typescript
export const Props: Story = {
  tags: ['show-panel'],
  render: () => (
    <Component prop="hardcoded" />  // Args not used!
  ),
}
```

‚úÖ **Correct - Controls will work:**
```typescript
export const Props: Story = {
  tags: ['show-panel'],
  args: {
    type: 'default',
    size: 'md',
  },
  render: (args) => (
    <Component type={args.type} size={args.size} />  // Args passed through!
  ),
}
```

‚úÖ **Also correct - Simple components can omit render:**
```typescript
export const Props: Story = {
  tags: ['show-panel'],
  args: {
    children: 'Label',
    color: 'primary',
  },
  // No render needed - Storybook renders Component with args automatically
}
```

### Compound Components (Tabs, Breadcrumbs, etc.)

For compound components, set `component` to the sub-component with the main props:

```typescript
const meta: Meta<typeof TabList> = {  // TabList has type, size, fullWidth
  title: 'Application/Tabs',
  component: TabList,  // Not Tabs!
  argTypes: {
    type: { control: 'select', options: [...] },
    size: { control: 'select', options: [...] },
  },
}
```

Then use a render function that wraps the sub-component:

```typescript
export const Props: Story = {
  render: (args) => (
    <Tabs>
      <TabList type={args.type} size={args.size}>
        {/* ... */}
      </TabList>
    </Tabs>
  ),
}
```

## 5. Story File Structure

```typescript
import type { Meta, StoryObj } from '@storybook/react'
import { Component } from './component'

const meta: Meta<typeof Component> = {
  title: 'Components/ComponentName',
  component: Component,
  parameters: { layout: 'centered' },
  argTypes: {
    // Organized by category (see above)
  },
  args: {
    // Default args
  },
}

export default meta
type Story = StoryObj<typeof Component>

// =============================================================================
// OVERVIEW (default - all variants by property)
// =============================================================================

export const Overview: Story = {
  render: () => (
    <div className="flex flex-col gap-8 px-12 pb-12 pt-8">
      {/* Group variants by property type: Hierarchy, Size, State, Icons, etc. */}
    </div>
  ),
}

// =============================================================================
// PROPS (with controls)
// =============================================================================

export const Props: Story = {
  tags: ['show-panel'],
  args: {
    // Interactive defaults
  },
}

// =============================================================================
// SOURCE CODE + DESIGN
// =============================================================================

export const SourceCodeAndDesign: Story = {
  name: 'Source Code + Design',
  render: () => (
    <div className="flex min-w-[480px] flex-col items-center gap-8 py-12">
      <div className="flex flex-col items-center gap-4 text-center">
        <h2 className="text-display-xs font-semibold text-primary">Source Code + Figma Design</h2>
        <p className="text-md text-tertiary">This component was built from the Untitled Design System</p>
      </div>
      <div className="flex gap-4">
        <Button
          href="https://github.com/PlayaLink/untitled-ds/tree/main/src/components/[component-name]"
          iconLeading={GitHubIcon}
          color="secondary"
        >
          View on GitHub
        </Button>
        <Button
          href="https://www.figma.com/design/[figma-file-key]/?node-id=[node-id]"
          iconLeading={FigmaIcon}
          color="primary"
        >
          View in Figma
        </Button>
      </div>
      {/* Optional: Include a small component demo below the buttons */}
    </div>
  ),
}
```

### Source Code + Design Pattern

The SourceCodeAndDesign story must render **actual Button components** with links:

```typescript
import { Button } from '../button'
import { createIcon } from '../icon'

const GitHubIcon = createIcon('github')
const FigmaIcon = createIcon('figma')

export const SourceCodeAndDesign: Story = {
  name: 'Source Code + Design',
  render: () => (
    <div className="flex min-w-[480px] flex-col items-center gap-8 py-12">
      <div className="flex flex-col items-center gap-4 text-center">
        <h2 className="text-display-xs font-semibold text-primary">Source Code + Figma Design</h2>
        <p className="text-md text-tertiary">This component was built from the Untitled Design System</p>
      </div>
      <div className="flex gap-4">
        <Button
          href="https://github.com/PlayaLink/untitled-ds/tree/main/src/components/button"
          iconLeading={GitHubIcon}
          color="secondary"
        >
          View on GitHub
        </Button>
        <Button
          href="https://www.figma.com/design/fDxXGrTItVnXVTWhtx7yuQ/?node-id=19483-3721"
          iconLeading={FigmaIcon}
          color="primary"
        >
          View in Figma
        </Button>
      </div>
    </div>
  ),
}
```

**Important:** Do NOT use `parameters.design` or `parameters.github` - render actual clickable buttons.

### Conditional Guidelines (Apply When Relevant)

#### `custom-component-implementation`
_Source: `untitled-ds/.ai-guidelines/conditional/custom-component-implementation.md`_


# Custom Component Implementation Workflow

Use this workflow when your Figma component **differs from the default Untitled UI design**. This strips features not present in your design.

## When to Use

- Figma component has been customized or simplified
- Only certain variants/sizes are needed
- Design system has diverged from standard Untitled UI

## Steps

### 1. Fetch Figma Data

Use the Figma MCP to fetch component data from the provided Figma link:

```
get_figma_data with fileKey and nodeId
```

Analyze the Figma data to understand:
- Which variants exist (Size, Hierarchy, State, Icon, etc.)
- Which props are actually used
- Any custom modifications from standard Untitled UI

### 3. Update Import Paths

Change imports to use project aliases:
- `@/utils/cx` for class merging (replace any `cn` or `clsx` imports)
- `@/utils/is-react-component` for component type checking

### 4. Add Documentation Header

```typescript
/**
 * ComponentName component
 * @docs https://www.untitledui.com/react/components/<component-name>
 * @figma <figma-url-with-node-id>
 */
```

### 5. Apply sortCx Pattern used by our other components

Reorganize styles using the `sortCx` pattern. Only include variants that exist in Figma:

```typescript
import { cx, sortCx } from '@/utils/cx'

export const styles = sortCx({
  common: {
    root: 'base classes',
  },
  sizes: {
    // Only sizes that exist in Figma
    sm: { root: '...' },
    md: { root: '...' },
  },
})

export type ComponentSize = keyof typeof styles.sizes
```

### 6. Create Storybook Stories

Create stories **only for variants that exist in your Figma**:

| Story | Purpose |
|-------|---------|
| `Overview` | Visual showcase of YOUR variants (not all Untitled UI variants) |
| `Props` | Interactive playground with `tags: ['show-panel']` |
| `SourceCodeAndDesign` | Links to GitHub source and Figma design |

**Do NOT include variants in stories that don't exist in your Figma.**

### 8. Validate Tokens

Check Storybook for visual issues. If styles look wrong:
1. Identify missing tokens
2. Update `tailwind.config.js`
3. Update `tokens/figma-update.json`
4. Notify user of token gaps

### 9. Export from Index

Update the component's barrel file and root exports:

```typescript
// src/components/<name>/index.ts
export { ComponentName, type ComponentNameProps, type ComponentNameSize, styles } from './component-name'
```

```typescript
// src/index.ts
export { ComponentName, type ComponentNameProps, type ComponentNameSize, styles as componentNameStyles } from './components/<name>'
```

## File Structure

```
src/components/<name>/
‚îú‚îÄ‚îÄ <name>.tsx           # Simplified component matching Figma
‚îú‚îÄ‚îÄ <name>.stories.tsx   # Stories for Figma variants only
‚îî‚îÄ‚îÄ index.ts             # Barrel exports
```

#### `design-tokens`
_Source: `untitled-ds/.ai-guidelines/conditional/design-tokens.md`_


# Design Token Architecture

## Token Flow

```
Figma Variables ‚Üí Export Plugin ‚Üí tokens/all-figma.tokens.json
                                         ‚Üì
                               npm run build:tokens
                                         ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚Üì                                         ‚Üì
        src/styles/tokens.css                    src/styles/tailwind-tokens.cjs
        (CSS variables + dark mode)              (Tailwind theme values)
                                                          ‚Üì
                                               tailwind.config.cjs (imports generated tokens)
```

**Single source of truth:** Figma exports 786 variables from 7 collections (Primitives, Light mode, Dark mode, Typography, Spacing, Widths/Radius, Containers).

## Updating Tokens from Figma

When tokens change in Figma:
1. Export via Plugins ‚Üí Development ‚Üí Variables Export
2. Save JSON to `tokens/all-figma.tokens.json`
3. Run `npm run build:tokens` to regenerate CSS variables and Tailwind config

## Generated Files

| File | Purpose |
|------|---------|
| `src/styles/tokens.css` | CSS custom properties with `:root` (light) and `[data-theme="dark"]` overrides |
| `src/styles/tailwind-tokens.cjs` | Tailwind theme values (colors, spacing, radius, widths, typography) |

## Dark Mode

Toggle dark mode by setting the `data-theme` attribute:
```js
document.documentElement.dataset.theme = "dark"  // Enable dark mode
document.documentElement.dataset.theme = "light" // Force light mode
// Remove attribute to follow system preference
```

The generated CSS includes `@media (prefers-color-scheme: dark)` for automatic system preference support.

## Styling Conventions

- **Tailwind 4** with `@import 'tailwindcss'` syntax in `src/styles/globals.css`
- **Config reference:** `@config '../../tailwind.config.cjs'`
- **Semantic aliases:** `primary` (brand), `destructive` (error)

## Semantic vs Primitive Tokens (Dark Mode Support)

**CRITICAL:** For dark mode to work, components MUST use semantic tokens instead of primitive color scales for grayscale colors.

### ‚ùå DON'T use primitive gray tokens (won't respond to dark mode):
```typescript
// These are static values that won't change with theme
'text-gray-900'    // Always #181d27
'text-gray-700'    // Always #414651
'text-gray-500'    // Always #717680
'bg-gray-50'       // Always #fafafa
'bg-gray-100'      // Always #f5f5f5
'border-gray-300'  // Always #d5d7da
'ring-gray-300'    // Always #d5d7da
```

### ‚úÖ DO use semantic tokens (responds to dark mode):
```typescript
// These use CSS variables that change with [data-theme="dark"]
'text-primary'           // Main text (gray-900 in light, gray-dark-50 in dark)
'text-secondary'         // Secondary text (gray-700 in light, gray-dark-300 in dark)
'text-tertiary'          // Muted text (gray-600 in light, gray-dark-400 in dark)
'text-quaternary'        // Very muted (gray-500 in light, gray-dark-400 in dark)
'text-disabled'          // Disabled text
'text-placeholder'       // Placeholder text

'bg-primary'             // Main background (white in light, gray-dark-950 in dark)
'bg-secondary'           // Subtle background (gray-50 in light, gray-dark-900 in dark)
'bg-tertiary'            // Slightly darker (gray-100 in light, gray-dark-800 in dark)
'bg-primary-hover'       // Hover state for primary bg
'bg-secondary-hover'     // Hover state for secondary bg

'border-primary'         // Main borders (gray-300 in light, gray-dark-700 in dark)
'border-secondary'       // Subtle borders (gray-200 in light, gray-dark-800 in dark)
'ring-border-primary'    // For ring-* utilities
'ring-border-secondary'  // For ring-* utilities
```

### Mapping Reference (Light ‚Üí Semantic):
| Primitive | Semantic Token |
|-----------|----------------|
| `text-gray-900` | `text-primary` |
| `text-gray-700` | `text-secondary` |
| `text-gray-600` | `text-tertiary` |
| `text-gray-500` | `text-tertiary` or `text-quaternary` |
| `text-gray-400` | `text-disabled` |
| `bg-base-white` | `bg-primary` |
| `bg-gray-50` | `bg-secondary` |
| `bg-gray-100` | `bg-tertiary` |
| `border-gray-300` | `border-primary` |
| `border-gray-200` | `border-secondary` |
| `ring-gray-300` | `ring-border-primary` |
| `ring-gray-200` | `ring-border-secondary` |

### When to Keep Primitives:
- **Colored badges/pills** (brand, error, warning, success colors) - these should be consistent across themes
- **Brand colors** (brand-500, brand-600) - intentionally static
- **Status colors** (error-500, success-500) - intentionally static

## How Dark Mode Works

The dark mode system uses two coordinated files:

1. **`tokens.css`** - Defines CSS custom properties with light mode defaults in `:root` and dark mode overrides in `[data-theme="dark"]`
2. **`tailwind-tokens.cjs`** - Exports semantic colors as CSS variable references (e.g., `primary: 'var(--color-border-primary)'`)

When Tailwind generates utilities like `ring-border-primary`, they reference the CSS variables which automatically respond to the theme attribute.

**Important:** Do NOT add semantic colors to `@theme` blocks in `globals.css` - this creates circular references that break the dark mode cascade.

## Available Color Utilities

All these Tailwind utilities support semantic tokens for dark mode:

| Utility | Example | Use Case |
|---------|---------|----------|
| `text-*` | `text-primary`, `text-secondary` | Text color |
| `bg-*` | `bg-primary`, `bg-secondary` | Background color |
| `border-*` | `border-primary`, `border-secondary` | Border color |
| `ring-*` | `ring-border-primary`, `ring-border-error` | Focus rings, outlines |
| `fill-*` | `fill-fg-primary` | SVG fill color |
| `stroke-*` | `stroke-fg-primary` | SVG stroke color |
| `divide-*` | `divide-border-secondary` | Divider lines |
| `outline-*` | `outline-border-primary` | Outline color |
| `caret-*` | `caret-fg-primary` | Text cursor color |
| `accent-*` | `accent-bg-brand-primary` | Form accent color |

## Token Naming Convention

**CRITICAL:** All token names use **hyphens**, not underscores.

### ‚ùå DON'T use underscores:
```typescript
'bg-secondary_alt'      // Wrong - uses underscore
'bg-primary_hover'      // Wrong - uses underscore
'text-fg-quaternary_hover'  // Wrong - uses underscore
'ring-secondary'        // Wrong - missing border- prefix
```

### ‚úÖ DO use hyphens:
```typescript
'bg-secondary-alt'      // Correct - uses hyphen
'bg-primary-hover'      // Correct - uses hyphen
'text-fg-quaternary-hover'  // Correct - uses hyphen
'ring-border-secondary' // Correct - has border- prefix
```

### Ring Color Pattern

For `ring-*` utilities with semantic colors, always include the category prefix:

| Wrong | Correct |
|-------|---------|
| `ring-primary` | `ring-border-primary` |
| `ring-secondary` | `ring-border-secondary` |
| `ring-error` | `ring-border-error` |

### Lint Check

Run `npm run lint:tokens` to catch naming issues:

```bash
npm run lint:tokens
```

This checks for:
- Underscore usage (`_alt`, `_hover`, `_subtle`, etc.)
- Missing `border-` prefix on ring colors

Add to CI to catch issues before merge.

## Troubleshooting

### Dark Mode Not Working

1. **Check `data-theme` attribute**: Ensure `<html data-theme="dark">` is set
2. **Verify CSS variables exist**: In DevTools, check that `--color-border-primary` etc. are defined on `:root`
3. **Disable browser extensions**: Dark Reader and similar extensions override all colors and will break your design system's dark mode

### Browser Extension Interference

If colors look wrong or `box-shadow: none` appears unexpectedly, check for browser extensions like **Dark Reader** that modify page colors. These extensions:
- Override CSS custom properties
- Remove shadows
- Replace your carefully designed dark mode with their own

Add sites to extension exclusion lists when developing.

## Utilities

Use `cx()` from `@/cx` for className merging (wraps tailwind-merge).

#### `npm-publishing`
_Source: `untitled-ds/.ai-guidelines/conditional/npm-publishing.md`_


# NPM Package Distribution

This design system is distributed as an NPM package via **GitHub Packages** (not public npm).

## Publishing a New Version

### Automated (preferred)

Pushing a git tag triggers GitHub Actions to build and publish automatically:

```bash
# 1. Build the library to verify it compiles
npm run build:lib

# 2. Bump version
npm version patch  # or minor/major (this commits + creates tag)

# 3. Push commit and tag ‚Äî CI publishes to GitHub Packages
git push && git push --tags
```

### Manual (if CI is unavailable)

```bash
# 1. Build the library
npm run build:lib

# 2. Bump version (--no-git-tag-version if you want to commit separately)
npm version patch

# 3. Publish directly (requires ~/.npmrc with GitHub Packages auth token)
npm publish

# 4. Commit, tag, and push
git add package.json package-lock.json
git commit -m "chore(release): v$(node -p 'require(\"./package.json\").version')"
git tag "v$(node -p 'require('./package.json').version')"
git push && git push --tags
```

### Authentication

Publishing requires a GitHub PAT with `write:packages` scope, configured in `~/.npmrc`:

```
//npm.pkg.github.com/:_authToken=ghp_YOUR_TOKEN_HERE
```

### TS4023 Warnings

The build emits TS4023 warnings about Dropdown's `HeaderProps` ‚Äî these are pre-existing and non-blocking. The package publishes correctly.

## When to Publish

**You MUST publish a new version when:**
- New components or exports are added that benchmarkr (or any consumer) references
- Existing component APIs change (props renamed/removed)
- Bug fixes that affect consumer behavior

**Vercel builds will fail** if benchmarkr's `components/ds/index.ts` re-exports something that doesn't exist in the published version. Locally this is masked by `npm link`.

## Consumer Setup

### .npmrc (required in consumer repo)

```
@playalink:registry=https://npm.pkg.github.com
//npm.pkg.github.com/:_authToken=${NPM_TOKEN}
```

The `${NPM_TOKEN}` env var is resolved at install time:
- **Locally**: falls through to `~/.npmrc` which has the token hardcoded
- **Vercel/CI**: set `NPM_TOKEN` as an environment variable

### CSS Setup

```css
@import 'tailwindcss';
@config '@playalink/untitled-ds/tailwind.config';
@import '@playalink/untitled-ds/styles/tokens';
@import '@playalink/untitled-ds/styles/globals';
@source 'node_modules/@playalink/untitled-ds/dist/**/*.js';
```

### Component Usage

```typescript
import { Button, Badge, Tag, ButtonGroup } from '@playalink/untitled-ds'
```

#### `untitled-ui-component`
_Source: `untitled-ds/.ai-guidelines/conditional/untitled-ui-component.md`_


# Untitled UI Component Workflow

This workflow applies when adding or updating components in the untitled-ds package.

## Quick Reference

See the global `untitled-ui-components.md` rule for the complete 8-step workflow:

1. Pull from Untitled UI CLI
2. Fetch Figma data for parity check
3. Verify prop/variant parity
4. Replace `@untitledui/icons` with `createIcon`
5. Apply semantic color tokens
6. Organize styles with `sortCx`
7. Create Storybook stories (3 required)
8. Export from index files

---

## untitled-ds Specific Notes

### Icon Replacement

All icons must use the `Icon` component architecture:

```tsx
import { createIcon } from '../icon'

const ChevronDownIcon = createIcon('chevron-down', 'sm')
```

Do NOT use `@untitledui/icons` directly in component code or stories.

### Storybook Commands

```bash
npm run dev        # Start Storybook dev server
npm run build      # Build Storybook static site
npm run build:lib  # Build library for consumption
```

### Library Build

After making changes, always rebuild the library:

```bash
npm run build:lib
```

This generates `dist/` which is what consuming apps import.

---

## Handling `_` Prefixed Figma Components

Components prefixed with `_` in Figma are internal/private building blocks.

### Decision: Standalone vs. Inline

| Approach | When to Use | Example |
|----------|-------------|---------|
| **Create standalone** | Reusable across parents | `MenuItem` for Dropdown, ContextMenu |
| **Inline into parent** | Tightly coupled to one parent | Internal item only used by one component |

### Example

`MenuItem` was created standalone because it's reused by `Dropdown` and other menu-like components:

```tsx
<Dropdown triggerLabel="Options">
  <MenuItem icon={EditIcon}>Edit</MenuItem>
  <MenuItem icon={CopyIcon}>Copy</MenuItem>
</Dropdown>
```

<!-- END: AI GUIDELINES SYNC (generated) -->















